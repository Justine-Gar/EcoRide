<!--=======   MODAl   =======-->

<!-- Modal de connexion -->
<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true"> 
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="loginModalLabel">Connexion</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<form id="loginForm" method="POST" action="{{ path('app_login') }}" class="needs-validation" novalidate>
					<div class="mb-3">
						<input type="email" class="form-control" id="loginEmail" name="_username" required placeholder="Entrez votre email" autocomplete="email">
					</div>
					<div class="mb-3">
						<input type="password" class="form-control" id="loginPassword"name="_password" required placeholder="Entrez votre mot de passe" autocomplete="current-password">
					</div>
					<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
					<div class="alert alert-danger d-none" id="loginError"></div>
					<div class="modal-footer justify-content-center">
						<button type="submit" class="btn btn-connexion">Se connecter</button>
					</div>
				</form>
			</div>
			<div class="text-center mb-3">
				<p>Pas encore de compte ?
					<a href="#" class="texte-vert" data-bs-toggle="modal" data-bs-target="#registerModal" data-bs-dismiss="modal">Inscrivez-vous</a>
				</p>
			</div>
		</div>
	</div>
</div>

<!-- Modal d'inscription -->
<div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="registerModalLabel">Inscription</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<form id="registerForm" method="POST">
					<div class="row mb-3">
						<div class="col">
							<label for="firstname" class="form-label">Prénom</label>
							<input type="text" class="form-control" id="firstname" name="firstname" required>
						</div>
						<div class="col">
							<label for="name" class="form-label">Nom</label>
							<input type="text" class="form-control" id="name" name="name" required>
						</div>
					</div>
					<div class="mb-3">
						<label for="email" class="form-label">Email</label>
						<input type="email" class="form-control" id="email" name="email" autocomplete="email" required>
					</div>
					<div class="mb-3">
						<label for="phone_number" class="form-label">Téléphone</label>
						<input type="tel" class="form-control" id="phone_number" name="phone_number" pattern="[0-9]{10}" required>
					</div>
					<div class="mb-3">
						<label for="register_password" class="form-label">Mot de passe</label>
						<input type="password" class="form-control" id="register-password" name="register_password" autocomplete="new-password" required>
					</div>
					<div class="mb-3">
						<label for="confirm_password" class="form-label">Confirmer le mot de passe</label>
						<input type="password" class="form-control" id="confirm-password" name="confirm_password" autocomplete="new-password" required>
					</div>
					<div class="mb-4">
						<label class="form-label">Je souhaite m'inscrire en tant que :</label>
						<div class="form-check">
								<input class="form-check-input" type="radio" name="role" id="role-passager" value="Passager" checked>
								<label class="form-check-label" for="role-passager">
										Passager
								</label>
						</div>
						<div class="form-check">
								<input class="form-check-input" type="radio" name="role" id="role-conducteur" value="Conducteur">
								<label class="form-check-label" for="role-conducteur">
										Conducteur
								</label>
						</div>
						<small class="text-muted">Vous pourrez changer de rôle ultérieurement depuis votre profil.</small>
					</div>
					<div class="alert alert-danger d-none" id="registerError"></div>
					<div class="form-check mb-3">
						<input type="checkbox" class="form-check-input" id="terms" name="terms" required>
						<label class="form-check-label" for="terms">
							J'accepte les conditions d'utilisation
						</label>
					</div>
					<div class="modal-footer justify-content-center">
						<button type="submit" class="btn btn-connexion" form="registerForm">S'inscrire</button>
					</div>
				</form>
			</div>
			<div class="text-center mb-3">
				<p>Déjà un compte ?
					<a href="#" class="texte-vert" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal">Connectez-vous</a>
				</p>
			</div>
		</div>
	</div>
</div>

<!-- Modal de filtrage -->
<div class="modal fade" id="filterModal" tabindex="-1" aria-labelledby="filterModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content filter-menu">
			<div class="modal-header">
				<h5 class="modal-title" id="filterModalLabel">Filtres de rechercher</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div
				class="modal-body">
				<!-- Type de véhicule -->
				<div class="filter-section">
					<label>Type de véhicule :</label>
					<div class="vehicle-options">
						<div class="form-check">
							<input class="form-check-input" type="radio" name="vehicleType" id="allVehicles" checked>
							<label class="form-check-label" for="allVehicles">Tous les véhicules</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" name="vehicleType" id="essence">
							<label class="form-check-label" for="essence">Essence</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" name="vehicleType" id="diesel">
							<label class="form-check-label" for="diesel">Diesel</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" name="vehicleType" id="hybrid">
							<label class="form-check-label" for="hybrid">Hybride</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="radio" name="vehicleType" id="electric">
							<label class="form-check-label" for="electric">Électrique</label>
						</div>
					</div>
				</div>

				<!-- Nombre de passagers -->
				<div class="filter-section">
					<label for="passager-count">Nombre de passager :</label>
					<input type="number" id="passager-count" class="form-control" min="1" max="4" value="1">
					<small class="text-muted">Max 4 passagers / véhicules, nous prennons en compte le conducteur</small>
				</div>

				<!-- Crédits maximum -->
				<div class="filter-section">
					<label>Crédits maximum :
						<span id="credit-value">20 crédits</span>
					</label>
					<input type="range" id="credit-range" class="form-range" min="0" max="50" value="20">
				</div>

				<!-- Note maximale du conducteur -->
				<div class="filter-section">
					<label for="driver-rating">Note minimal du conducteur :</label>
					<input type="number" id="driver-rating" class="form-control" min="0" max="5" step="0.1" value="5">
				</div>

				<!-- Bouton Filtrer -->
				<div class="text-center mt-4">
					<button class="btn btn-modal-filtre">Filtrer</button>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Modal de création de trajet -->
<div class="modal modal-xl fade" id="createTripModal" tabindex"-1" aria-labelledby="createTripModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="createTripModalLabel">Créer un covoiturage</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="row g-0">

					<!-- Carte à gauche -->
					<div class="col-md-5">
						<label class="form-label">Itinéraire</label>
						<div id="mapPreview" style="height: 100%; min-height: 500px; border-radius: 8px 0 0 8px;"></div>
					</div>

					<!-- Formulaire à droite -->
					<div class="col-md-7 p-4">
						<form id="createCarpoolForm" method="post" action="{{ path('app_covoiturage_new')}}">

						<!-- Départ / Arrivée -->
							<div class="row mb-3">
								<div class="col-md-6">
									<label for="location_start" class="form-label">Lieu de départ</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
										<input type="text" class="form-control" id="location_start" name="location_start" placeholder="Ville, adresse de départ" required>
									</div>
									<input type="hidden" id="lat_start" name="lat_start">
									<input type="hidden" id="lng_start" name="lng_start">
								</div>
								<div class="col-md-6">
									<label for="location_reach" class="form-label">Lieu d'arrivée</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-flag-checkered"></i></span>
										<input type="text" class="form-control" id="location_reach" name="location_reach" placeholder="Ville, adresse d'arrivée" required>
									</div>
									<input type="hidden" id="lat_reach" name="lat_reach">
									<input type="hidden" id="lng_reach" name="lng_reach">
								</div>
							</div>


						<!-- Date / Heure Départ/Arrivée -->
							<div class="row mb-3">
								<div class="col-md-3">
									<label for="date_start" class="form-label">Date de départ</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
										<input type="date" class="form-control" id="date_start" name="date_start" required min="{{ 'now'|date('Y-m-d') }}">
									</div>
								</div>
								<div class="col-md-3">
									<label for="hour_start" class="form-label">Heure de départ</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-clock"></i></span>
										<input type="time" class="form-control" id="hour_start" name="hour_start" required>
									</div>
								</div>
								<div class="col-md-3">
									<label for="date_reach" class="form-label">Date d'arrivée</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
										<input type="date" class="form-control" id="date_reach" name="date_reach" required min="{{ 'now'|date('Y-m-d') }}">
									</div>
								</div>
								<div class="col-md-3">
									<label for="hour_reach" class="form-label">Heure d'arrivée</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-clock"></i></span>
										<input type="time" class="form-control" id="hour_reach" name="hour_reach" required>
									</div>
								</div>
							</div>


						<!-- Véhicule et Nombre de places -->
							<div class="row mb-3">
								<div class="col-md-6">
									<label for="car_id" class="form-label">Véhicule</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-car"></i></span>
										<select class="form-select" id="car_id" name="car_id" required>
											<option value="" selected disabled>Choisissez votre véhicule</option>
											{% if cars is defined and cars is not empty %}
												{% for car in cars %}
													<option value="{{ car.id }}">{{ car.marque }} {{ car.modele }} ({{ car.color }})</option>
												{% endfor %}
											{% else %}
												<option value="" disabled>Aucun véhicule disponible</option>
											{% endif %}
										</select>
									</div>
								</div>
								<div class="col-md-6">
									<label for="nbr_places" class="form-label">Nombre de places disponibles</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-user-friends"></i></span>
										<select class="form-select" id="nbr_places" name="nbr_places" required>
											<option value="" selected disabled>Nombre de places</option>
											<option value="1">1 place</option>
											<option value="2">2 places</option>
											<option value="3">3 places</option>
											<option value="4">4 places</option>
										</select>
									</div>
								</div>
							</div>


						<!-- Crédits -->
							<div class="row mb-3">
								<div class="col-md-6">
									<label for="credits" class="form-label">Prix (en crédits)</label>
									<div class="input-group">
										<span class="input-group-text"><i class="fas fa-coins"></i></span>
										<input type="number" class="form-control" id="credits" name="credits" min="5" max="50" value="20" required>
									</div>
									<small class="form-text text-muted">Prix par passager (entre 5 et 50 crédits)</small>
								</div>
								
							</div>
							
						<!-- Préférences -->
							<div class="mb-3">
								<label class="form-label">Préférences</label>
								<div class="d-flex flex-wrap gap-2">
									<div class="form-check form-check-inline">
										<input class="form-check-input" type="checkbox" id="preference_smoke" name="user_preferences[]" value="non_fumeur">
										<label class="form-check-label" for="preference_smoke"><i class="fas fa-smoking-ban"></i> Non fumeur</label>
									</div>
									<div class="form-check form-check-inline">
										<input class="form-check-input" type="checkbox" id="preference_music" name="user_preferences[]" value="musique">
										<label class="form-check-label" for="preference_music"><i class="fas fa-music"></i> Musique</label>
									</div>
									<div class="form-check form-check-inline">
										<input class="form-check-input" type="checkbox" id="preference_animals" name="user_preferences[]" value="animaux">
										<label class="form-check-label" for="preference_animals"><i class="fas fa-paw"></i> Animaux acceptés</label>
									</div>
								</div>
							</div>
							

						<!-- Résumer trajet -->
							<div class="alert alert-info" id="tripSummary" style="display: none;">
								<h6 class="alert-heading">Résumé du trajet</h6>
								<p id="summaryText"></p>
								<p id="summaryPrice" class="mb-0"></p>
							</div>

							<input type="hidden" name="_csrf_token" value="{{ csrf_token('create_carpool') }}">

						</form>
					</div>
	
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
        <button type="submit" form="createCarpoolForm" class="btn btn-green">Créer le covoiturage</button>
			</div>
		</div>
	</div>
</div>

<!-- Modal ajouter une voiture -->
<div class="modal fade" id="addVehicleModal" tabindex="-1" aria-labelledby="addVehicleModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="addVehicleModalLabel">Ajouter un véhicule</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				{{ form_start(carForm) }}
				<div class="mb-3">
					{{ form_row(carForm.marque) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.modele) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.color) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.energie) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.nbr_places) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.license_plate) }}
				</div>
				<div class="mb-3">
					{{ form_row(carForm.first_registration) }}
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
					<button type="submit" class="btn btn-primary">Ajouter</button>
				</div>
				{{ form_end(carForm) }}
			</div>
		</div>
	</div>
</div>


<!--div></div-->